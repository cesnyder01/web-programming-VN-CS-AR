<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="src/style.css" />
</head>
<body>
  <main class="login wrapper">
    <h1>Login</h1>


    <div id="form-status" class="visually-hidden" aria-live="polite"></div>

    <div class="box" role="form" aria-labelledby="login-title">
      <form action="/login" method="POST" novalidate>
        <input type="hidden" name="csrf_token" value="{{CSRF_TOKEN}}" />

        <fieldset>
          <legend id="login-title">Sign in to your account</legend>

          <div class="field">
            <label for="email">Email</label>
            <input
              type="email"
              id="email"
              name="email"
              placeholder="you@example.com"
              autocomplete="username"
              inputmode="email"
              spellcheck="false"
              autocapitalize="off"
              required
            />
            <p class="field-hint" id="email-hint">Use the email you registered with.</p>
            <p class="field-error" id="email-error" aria-live="polite"></p>
          </div>

          <div class="field">
            <label for="password">Password</label>
            <div class="password-wrap">
              <input
                type="password"
                id="password"
                name="password"
                placeholder="Enter your password"
                autocomplete="current-password"
                minlength="8"
                required
                aria-describedby="password-hint"
              />
              <button type="button" class="toggle-password" aria-controls="password" aria-pressed="false">
                Show
              </button>
            </div>
            <p class="field-hint" id="password-hint">At least 8 characters.</p>
            <p class="field-error" id="password-error" aria-live="polite"></p>
          </div>

          <div class="field align-right">
            <a class="link-small" href="/forgot-password" aria-describedby="email-hint">Forgot password?</a>
          </div>

          <div class="actions">
            <button type="submit" id="login-button" name="action" value="login">Login</button>
          </div>
        </fieldset>
      </form>

      <p>No account?
        <a href="register.html">Create an account</a>
      </p>
    </div>
  </main>

  <script>
    (function () {
      const btn = document.querySelector('.toggle-password');
      const input = document.getElementById('password');
      if (btn && input) {
        btn.addEventListener('click', () => {
          const showing = input.type === 'text';
          input.type = showing ? 'password' : 'text';
          btn.setAttribute('aria-pressed', String(!showing));
          btn.textContent = showing ? 'Show' : 'Hide';
        });
      }
    }());

    (function () {
      const form = document.querySelector('form[action="/login"]');
      const submit = document.getElementById('login-button');
      if (form && submit) {
        form.addEventListener('submit', () => {
          submit.disabled = true;
          submit.setAttribute('aria-busy', 'true');
        });
      }
    }());
  </script>

  <style>
    .visually-hidden {
      position: absolute !important;
      height: 1px; width: 1px;
      overflow: hidden; clip: rect(1px, 1px, 1px, 1px);
      white-space: nowrap;
    }
    .align-right {
      text-align: right;
      margin-top: -0.5em;
      margin-bottom: 1.5em;
    }
  </style>
</body>
</html>
